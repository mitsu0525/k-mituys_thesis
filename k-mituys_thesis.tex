\documentclass[a4paper,11pt]{jarticle}
\usepackage{ics-thesis}
\usepackage{amssymb}
\usepackage[dvipdfmx]{graphicx}
\usepackage{subfig}
\graphicspath{{./figures/}}
\captionsetup[subfigure]{subrefformat=simple,labelformat=simple,listofformat=subsimple}
\renewcommand\thesubfigure{(\alph{subfigure})}
\usepackage{svg}
\setsvg{inkscapepath=../figures/}
\svgpath{{./figures/}}
\usepackage{amsmath}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\usepackage{algorithm, algpseudocode}
\usepackage{here}
\pagestyle{bachelorthesis}
%
\title{多様な端末が混在する無線LANにおけるベイズ最適化を用いた\\アクセスポイント制御方式}
\author{光安 海}
\supervisor{若宮 直紀 教授}
\deadline{2019年2月12日}
%
\begin{document}
\titlepage    % 規定の.styファイルを使う場合
\abstract     % 規定の.styファイルを使う場合
%%%%%%%%%%%%%%%%%%%%%
% 内容梗概本文
%%%%%%%%%%%%%%%%%%%%%
研究背景と目的．やったこと．その結果．

\keyword
%%%%%%%%%%%%%%%%%%%%%
% キーワード
%%%%%%%%%%%%%%%%%%%%%
無線LAN，アクセスポイント制御，チャネル割当，ベイズ最適化
\tableofcontents    % 目次
%
%%%%%%%%%%%%%%%%%%%%%
% 本文
%%%%%%%%%%%%%%%%%%%%%
%
\section{はじめに}
無線技術の高速化や無線機器の低コスト化にともない，IEEE802.11無線LAN[802.11規格のspecificationを引用する]の普及が加速している．企業内や公共施設などにおいて，複数の無線アクセスポイント(AP)をサービス提供領域に敷設し無線接続サービスを提供することもあたりまえになってきた．

一方で，無線LANに接続可能な機器も増加するだけではなく，トラヒック特性や機器の性能，制御方式などの異なる端末が同一の無線LAN環境内で混在するような状況になってきている．
例えば，

一方で，複数のAPが敷設された無線LAN環境においては，チャネル制御[該当する方式の複数文献を引用する]によってAPや端末における干渉を軽減することでスループットを向上させている．(引用した方式の説明をその方式のポイントを抑えながら説明する)

したがって，そのような状況において，無線LAN環境全体の性能を改善するためには，APと端末の双方が協調した制御を行うことが必要である．しかしながら，以上のような多様な端末が混在する環境においては，そのような方式の実現は難しい．それは(その理由を適切に説明する)からである．そのため，端末の性能や種類，および要求品質などの違いに依存しない，制御方式が必要である．

そこで本報告では，多様な端末が混在する無線LAN環境において，ベイズ最適化を用いたAP制御方式を提案する．提案方式では，APによる制御と端末間の挙動の応答関係を不明なものとして扱う．そのもとで，ブラックボックス関数の最適化に用いられるベイズ最適化を適用することで，〇〇なアクセスポイント制御方式を実現する．具体的には，(具体的に提案方式の特徴を適切に説明する)．

どんな環境で提案方式を評価して何を示すか具体的に書いてください．

\section{ベイズ最適化\cite{Brochu2010}}
\subsection{概要}
ベイズ最適化は，目的関数の値を最大または最小にする変数の値を求める最適化アルゴリズムの一つである．
ベイズ最適化では，目的関数の事前分布がガウス過程に従うと仮定し，値が得られているデータを基づき，ベイズの定理より事後分布を求める．
また，探索(不確実性が高い範囲での実験)と活用(改善が見込める範囲での実験)の両方を考慮した獲得関数によって，次に実験する点を決定する．
実験により新たに得られたデータを含めて事後分布を再び求め，実験を繰り返すことで，目的関数の値を最大または最小にする点に収束する．
ベイズ最適化はグリッドサーチ法と比べて，効率良く計算できるため，計算コストが高い機械学習のハイパーパラメータ探索などに用いられる．

\subsection{獲得関数}
獲得関数は，ベイズ最適化において次に実験する点を決める役割を担っている．使用する獲得関数とそのパラメータによって探索と活用のバランスが変わる．
以下にベイズ最適化で使用される獲得関数の例を3つ挙げる．

$i$回目に実験した点を$\mathbf{x}_i$，目的関数の値を$f(\mathbf{x}_i)$とする．
ここでは，目的関数を最大化することを考え，$t$回の実験における最大値を$f(\mathbf{x}^+)$で表す．
ただし，$\mathbf{x}^+ = \argmax_{\mathbf{x}_i \in \mathbf{x}_{1:t}} f(\mathbf{x}_i)$である．

\subsubsection{Probability of Improvement (PI)}
$f(\mathbf{x})$が$f(\mathbf{x}^+)$より改善される確率PIは，探索と活用のトレードオフを制御するパラメータ$\xi\geq0$を導入して式(\ref{PI})で求められる．
\begin{equation}
  \text{PI}(\mathbf{x})=\Phi \left(\frac{\mu(\mathbf{x})-f(\mathbf{x}^+)-\xi}{\sigma(\mathbf{x})}\right) \label{PI}
\end{equation}
$\Phi(・)$は正規累積分布関数，$\mu(・)$と$\sigma(・)$はそれぞれガウス過程から得られた平均と分散を表している．

PIでは，パラメータ$\xi$によってgreedyの度合いを緩和しているが，それでも局所的最適解に陥りやすい．

\subsubsection{Expected Improvement (EI)}
$f(\mathbf{x})$が$f(\mathbf{x}^+)$より改善される期待値EIは，探索と活用のトレードオフを制御するパラメータ$\xi\geq0$導入して式(\ref{EI})で求められる．
\begin{equation}
  \text{EI}(\mathbf{x}) = \left \{
  \begin{array}{ll}
    (\mu(\mathbf{x})-f(\mathbf{x}^+)-\xi)\Phi(Z) + \sigma(\mathbf{x})\phi(Z) & (\sigma(\mathbf{x}) > 0) \\
    0 & (\sigma(\mathbf{x}) = 0) \label{EI}
  \end{array}
  \right.
\end{equation}
ただし，
$$
  Z = \left \{
  \begin{array}{ll}
    \frac{\mu(\mathbf{x})-f(\mathbf{x}^+)-\xi}{\sigma(\mathbf{x})} & (\sigma(\mathbf{x}) > 0) \\
    0 & (\sigma(\mathbf{x}) = 0)
  \end{array}
  \right.
$$
$\phi(・)$と$\Phi(・)$はそれぞれ標準正規分布の確率密度関数と累積分布関数を表している．
$\xi=0.01$だとうまくいきやすい\cite{Lizotte:2008:PBO:1626686}．

\subsubsection{Gaussian Process Upper Confidence Bound (GP-UCB)}
ガウス過程で回帰した関数$f(\mathbf{x})$の信頼上限は，探索の重きを調整するパラメータ$\nu$を導入して式(\ref{UCB})で求められる．

\begin{equation}
  \text{GP-UCB}(\mathbf{x})=\mu(\mathbf{x})+\sqrt{\nu\tau_t}\sigma(\mathbf{x}) \label{UCB}
\end{equation}
ただし，
$$\tau_t=2\log\left(\frac{t^{\frac{d}{2}+2}\pi^2}{3\delta}\right)$$

$\delta$は開区間(0,1)の任意の実数，$d$は$\mathbf{x}$の次元数である．
1-$\delta$以上の確率で最適値に収束するが保証されている\cite{Srinivas}．

\section{ベイズ最適化を用いたアクセスポイント制御方式}
アクセスポイントが制御できる要素であるチャネル割当とアクセスポイント割当を入力$\mathbf{x}$とし，
無線LANの合計スループットを目的関数$f(\mathbf{x})$とする．
ベイズ最適化を用いて，目的関数$f(\mathbf{x})$を最大にする入力
$\argmax_{\mathbf{x}} f(\mathbf{x})$を求める．
これにより無線LANの合計スループットを最大にするチャネル割当とアクセスポイント割当を得る．

ベイズ最適化の計算は無線LANの全アクセスポイントに接続するコントローラで行う．
コントローラがベイズ最適化を用いて得たチャネル割当とアクセスポイント割当をアクセスポイントに送り，アクセスポイントが計算した無線LANの合計スループットをコントローラに送る．

チャネル割当とアクセスポイント割当を目的関数の入力として扱うために，
アクセスポイントが利用できるチャネルと端末が利用できるアクセスポイントにそれぞれラベルを付ける．
このとき，目的関数への入力の次元数は$(アクセスポイント台数+端末台数)$となる．

アクセスポイントのチャネル割当を変える頻度を減らすために，チャネル割当のベイズ最適化の中でアクセスポイント割当のベイズ最適化を行う．
チャネル割当のベイズ最適化とアクセスポイント割当のベイズ最適化をそれぞれA,Bとすると，フローチャートは図\ref{control_flow}である．
あるチャネル割当のもとでの最適なアクセスポイント割当をベイズ最適化を用いて求める．求めたアクセスポイント割当のもとでの最適なチャネル割当をベイズ最適化を用いて決める．これらを繰り返し行い，最適なチャネル割当とアクセスポイント割当を得る．

\begin{figure}[t]
  \centering
  \includegraphics[width=15cm]{control_flow.pdf}
  \caption{提案手法のフローチャート}
  \label{control_flow}
\end{figure}

\section{シミュレーション評価}
整数の入力に対応するために文献\cite{Garrido-Merchan2018}の提案方法を採用したとき，
ベイズ最適化のイテレーションに対するスループットの変化を調べる．

\subsection{簡易スループットモデル\cite{Wu2000}}
ネットワークの端末$i$のスループット$\eta_i$は式(\ref{model})で求められる．ただし，$s$は使用できるチャネル数，$m_i$は端末$i$の隠れ端末の台数，$m_i$は端末$i$のさらし端末の台数である．
\begin{equation}
  \eta_i=\frac{s}{m_i+1}e^{-\frac{2n_i}{m_i+1}} \label{model}
\end{equation}
端末数が$n$である無線LANの合計スループットは式(\ref{total_throughput})で求められる．
\begin{equation}
  S_n=\sum_{k=0}^{n}\eta_k \label{total_throughput}
\end{equation}

\subsection{シミュレーション環境および設定}
ベイズ最適化を実行する無線LANは図\ref{position}である．
アクセスポイントの位置は固定で，端末は少なくとも一台のアクセスポイントと接続できる位置にランダムに配置される．無線LANとベイズ最適化のパラメータはそれぞれ表\ref{network_parameter}と表\ref{bayes_parameter}である．

\begin{figure}[t]
  \centering
  \includesvg[width=10cm]{network-random-50.svg}
  \caption{アクセスポイントと端末の配置図}
  \label{position}
\end{figure}

\begin{table}[H]
\centering
\caption{無線LANのパラメータ}
\begin{tabular}{l|lll}
パラメータ & 値 &  &  \\ \cline{1-2}
アクセスポイント台数 & 4 (台)  &  &  \\
端末台数 & 50 (台) &  &  \\
チャネル数 & 2 &  &  \\
通信可能距離  & 30 &  &  \\
干渉距離 & 45 &  &  \\
\end{tabular}
\label{network_parameter}
\end{table}

\begin{table}[H]
\centering
\caption{ベイズ最適化のパラメータ}
\begin{tabular}{l|lll}
パラメータ & 値 &  &  \\ \cline{1-2}
獲得関数 & EI ($\xi=0.01$)&  &  \\
カーネル & Matern 5/2 &  &  \\
最大イテレーション & 400 (回) &  & \\
\end{tabular}
\label{bayes_parameter}
\end{table}

\subsubsection{アクセスポイント選択アルゴリズム}
端末に適用するアクセスポイント選択アルゴリズムを以下に示す．
アルゴリズム1は実際によく使われている．アルゴリズム2は一定以上のスループットを必要とする端末を想定している．今回の実験では閾値を0.06に設定している．

\begin{description}
  \item[アルゴリズム1]最も電波強度が高いアクセスポイントに接続
  \item[アルゴリズム2]スループットが閾値以下のとき接続先アクセスポイントを変更
\end{description}

\subsubsection{アソシエーション}
簡易的なアソシエーションの動作はAlg.\ref{alg:assoc}である．
ただし，$max\_rejection$と$max\_request$はそれぞれアクセスポイントの最大アソシエーション拒否回数と端末の最大アソシエーション要求回数である．
今回の実験では，$max\_rejection$は5回に固定し，$max\_request$は区間[1,10]の整数からランダムに決めている．

\begin{algorithm}[H]
  \caption{：アソシエーション}
  \label{alg:assoc}
  \begin{algorithmic}[1]
    \If{$max\_rejection \geq max\_request$}
      \State ベイズ最適化のAP割当に従う
    \Else
      \State 端末のAP選択アルゴリズムに従う
    \EndIf
  \end{algorithmic}
\end{algorithm}

\subsection{評価指標}
単純なチャネル割当アルゴリズムと比較し，提案手法の有効性を評価する．スループットの低下を抑えながら最適化を進めていることを強化するために，時間に対する平均スループットの変化を指標として考えている．

\subsection{シミュレーション結果}
実験の結果は図\ref{hetero}，\ref{histogram}である．
初期値次第ではスループットが低い点でベイズ最適化が止まるため，工夫が必要だと考えている．
また，良くないチャネル割当を入力したときにスループットが1付近まで落ちる．
良くないチャネル割当では，AP割当のベイズ最適化を進めても変化が少ないことから，チャネル割当に制限を設けることや早くにベイズ最適化を打ち切る工夫などが考えられる．

図\ref{histogram}は100回の実験を行なったとき最終的に得られたスループットの最良値のヒストグラムである．
図\ref{histogram}の赤い線は参考値として，今までに行なった同じネットワークの配置での実験の中での最大値を示している．
度数の高い階級がスループットの大きい方へ寄っている．初期値に対してスループットを向上できる確率は高いと言えるが，最適値にたどり着くことはできていない．
また，スループットが低い階級ではベイズ最適化が途中で止まってしまうためにチャネル割当の探索が十分にできていなかった．

\begin{figure}[t]
  \centering
  \includesvg[width=\textwidth]{hetero20}
  \caption{イテレーションに対するスループットの変化}
  \label{hetero}
\end{figure}

\begin{figure}[t]
  \centering
  \includesvg[width=\textwidth]{histogram}
  \caption{100回の実験における最良値のヒストグラム}
  \label{histogram}
\end{figure}

\section{おわりに}
やったこと．シミュレーション結果から得られた知見．今後の課題．

\acknowledgement
本報告を終えるにあたり，日頃よりご指導，ご教授をいただきました大阪大学情報科学研究科の若宮直紀教授に心より感謝申し上げます．ならびに，終始丁寧なご指導をいただきました大阪大学情報科学研究科の橋本匡史助教に心より御礼申し上げます. さらに本報告を作成するにあたり，様々な助言をいただきました若宮研究室の方々に深く感謝申し上げます.

\bibliographystyle{IEEEtran}
\bibliography{bibliography}
\end{document}
